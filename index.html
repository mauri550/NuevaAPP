<!DOCTYPE html>
<html>
	<head>
		<title>Canvas Plugin</title>

		<script type="text/javascript" charset="utf-8" src="js/phonegap.0.9.5.js"></script>
		<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
		<script type="text/javascript" charset="utf-8" src="js/canvas.js"></script>
		<script type="text/javascript">
		try {
			var canSave = false;
			var b_canvas;
			function init() {

				document.addEventListener('deviceready', function() {
					canSave = true;
				});

				b_canvas = document.getElementById('cid');
				var b_context = b_canvas.getContext('2d');
				b_context.fillRect(50, 25, 150, 100);
			}
			function saveImg() {

				if (canSave) {

					window.plugins.canvas.toDataURL(b_canvas, "image/png", success, failure);
					function success(arg) {
						
						if (arg.size > 0) {
							var oImgElement = document.createElement("img");
							oImgElement.src = arg.data;
							$('#img').append(oImgElement);
						} else {			
							//document.getElementById('img').innerHTML(arg.data);
							alert("Canvas Write Error: " + arg.debug);
						}
					}
					function failure(arg) {
						alert("failure: " + arg);
					}
				}
			}
		} catch(err) { alert(err); }
		</script>
		<style type="text/css">
			#img img {
				/* border: 1px solid #f00; */
			}
			html, body { margin: 0; }
		</style>
	</head>

	<body onload="init();">
	
	<div style="width: 700px;">
	
		<br/><br/>
		<a href="#" onclick="saveImg();">SAVE</a>
		<div id="img" style="float: left; border: 1px dotted;"></div>
		<br clear="both"/>
		<div style="margin-top: 630px; float: right;">
			<canvas id="cid" width="300" height="225"></canvas>
		</div>
		
	</div>
		
	</body>
</html>